# Automation Walkthrough

## 1. Introduction
This document explains the internal logic of the `Test_001_Registration` automation script, mapping user actions to code execution.

## 2. Automation Flow Checklist

| Step | Portal Page | Automation Logic | Verification |
|------|-------------|------------------|--------------|
| 1 | **Login/Basic Details** | `RegistrationPage.set_name`, `set_dob` | Modal handled (`handle_modal`), UDISE verified. |
| 2 | **Eligibility** | `EligibilityPage.set_date_of_appointment` | Checks URL contains `eligibility`. |
| 3 | **Authentication** | `AuthenticationPage.set_email` | Uses incremental email logic (`DataUtils`) to ensure uniqueness. |
| 4 | **OTP Verification** | `OTPPage` (Manual Entry) | Script waits (`explicit_wait`) for user input. |
| 5 | **Personal Info** | `PersonalInformationPage` | Dropdowns selected using robust `BasePage` methods. |
| 6 | **Address Details** | `AddressDetailsPage.select_state` | dynamic wait for District dropdown to populate. |
| 7 | **Subject Details** | `SubjectDetailsPage` | Auto-detects enabled subjects and selects "Any" -> "English/Hindi". |
| 8 | **Documents** | `DocumentsPage.upload_all_documents` | Uses dummy files generated by `DataUtils`. |
| 9 | **Payment Review** | `PaymentFlowPage.check_all_confirmation_boxes` | JS-based clicks to toggle checkboxes. |
| 10 | **Gateway** | `PaymentFlowPage.enter_card_details` | Switch to Frames, enter dummy card, simulate success. |

## 3. Key Automations Explained

### A. Dynamic Data Generation
Instead of hardcoding data, the framework uses `utilities/data_utils.py`:
- **Emails**: `insphere.shubhamsingh+N@gmail.com` (Where N increments every run).
- **Files**: `dummy.jpg` and `dummy.pdf` are created on the fly if missing.

### B. Robust Dropdown Handling
The `BasePage.select_chosen_option` method handles the complex "Chosen.js" dropdowns used in the portal by:
1. Trying to click the "Chosen" UI container.
2. If that fails, unhiding the standard `<select>` element and interacting with it directly.
3. Supporting partial text matches (e.g., "Delhi" matches "GOVT OF DELHI").

### C. Payment Gateway Interaction
The SabPaisa gateway often uses iframes. The `PaymentFlowPage` uses a smart retry loop:
1. Scans the page for frames.
2. Switches to each frame to look for card input fields (`cardNumber`).
3. Once found, enters data and switches back.

## 4. Execution Recording
To record the execution:
- The automation tool automatically attempts to record the session.
- Developers can use tools like OBS Studio to capture the screen during `python -m pytest` execution.
